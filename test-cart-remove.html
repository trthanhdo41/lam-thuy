<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Cart Remove</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .luxury-black { color: #1a1a1a; }
        .luxury-gold { color: #D4AF37; }
        .bg-luxury-gold { background-color: #D4AF37; }
        .bg-luxury-black { background-color: #1a1a1a; }
    </style>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-luxury-black mb-8">Test Cart Remove Function</h1>
        
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">Test Products</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="border rounded-lg p-4">
                    <h3 class="font-semibold">Áo sơ mi nam</h3>
                    <p class="text-luxury-gold font-bold">2,500,000₫</p>
                    <button onclick="addToCart(1)" class="mt-2 bg-luxury-gold text-luxury-black px-4 py-2 rounded hover:bg-yellow-600">
                        Thêm vào giỏ
                    </button>
                </div>
                <div class="border rounded-lg p-4">
                    <h3 class="font-semibold">Váy dạ hội</h3>
                    <p class="text-luxury-gold font-bold">3,200,000₫</p>
                    <button onclick="addToCart(2)" class="mt-2 bg-luxury-gold text-luxury-black px-4 py-2 rounded hover:bg-yellow-600">
                        Thêm vào giỏ
                    </button>
                </div>
                <div class="border rounded-lg p-4">
                    <h3 class="font-semibold">Giày sneaker</h3>
                    <p class="text-luxury-gold font-bold">3,500,000₫</p>
                    <button onclick="addToCart(101)" class="mt-2 bg-luxury-gold text-luxury-black px-4 py-2 rounded hover:bg-yellow-600">
                        Thêm vào giỏ
                    </button>
                </div>
            </div>
        </div>
        
        <div class="bg-white rounded-lg shadow-lg p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold">Giỏ hàng (<span id="cart-count">0</span>)</h2>
                <button onclick="openCart()" class="bg-luxury-gold text-luxury-black px-4 py-2 rounded hover:bg-yellow-600">
                    Xem giỏ hàng
                </button>
            </div>
            
            <div id="cart-items" class="space-y-4">
                <!-- Cart items will be displayed here -->
            </div>
        </div>
    </div>
    
    <!-- Cart Modal -->
    <div id="cart-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-2xl w-full max-h-[80vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-luxury-black">Giỏ hàng</h2>
                    <button onclick="closeCart()" class="text-gray-400 hover:text-luxury-black text-2xl">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div id="empty-cart" class="text-center py-8 hidden">
                    <i class="fas fa-shopping-cart text-6xl text-gray-300 mb-4"></i>
                    <p class="text-gray-500 text-lg">Giỏ hàng trống</p>
                </div>
                
                <div id="cart-items-modal" class="space-y-4">
                    <!-- Cart items will be displayed here -->
                </div>
                
                <div class="mt-6 pt-4 border-t border-gray-200">
                    <div class="flex justify-between items-center">
                        <span class="text-lg font-semibold">Tổng cộng:</span>
                        <span id="cart-total" class="text-2xl font-bold text-luxury-gold">0₫</span>
                    </div>
                </div>
                
                <div class="mt-6 flex space-x-3">
                    <button onclick="clearCart()" class="flex-1 bg-gray-500 text-white py-3 rounded-lg font-semibold hover:bg-gray-600">
                        Xóa tất cả
                    </button>
                    <button onclick="openMessengerWithCart()" class="flex-1 bg-luxury-gold text-luxury-black py-3 rounded-lg font-semibold hover:bg-yellow-600">
                        Đặt hàng
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Size Color Modal -->
    <div id="sizeColorModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <!-- Modal content will be generated by JavaScript -->
    </div>
    
    <!-- Size Guide Modal -->
    <div id="sizeGuideModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <!-- Modal content will be generated by JavaScript -->
    </div>
    
    <script src="global-cart.js"></script>
    
    <script>
        // Test function to add sample items
        function addTestItems() {
            console.log('Adding test items...');
            
            // Add some test items directly to cart
            cart.push({
                id: 1,
                name: "Áo sơ mi nam cao cấp",
                price: 2500000,
                image: "https://images.unsplash.com/photo-1596755094514-f87e34085b2c?w=400&h=300&fit=crop",
                category: "clothing",
                quantity: 1,
                size: "S",
                color: "Đen"
            });
            
            cart.push({
                id: 1,
                name: "Áo sơ mi nam cao cấp",
                price: 2500000,
                image: "https://images.unsplash.com/photo-1596755094514-f87e34085b2c?w=400&h=300&fit=crop",
                category: "clothing",
                quantity: 1,
                size: "L",
                color: "Trắng"
            });
            
            cart.push({
                id: 2,
                name: "Váy dạ hội sang trọng",
                price: 3200000,
                image: "https://images.unsplash.com/photo-1515372039744-b8f02a3ae446?w=400&h=300&fit=crop",
                category: "clothing",
                quantity: 2,
                size: "XL",
                color: "Xám"
            });
            
            updateCartCount();
            updateCartDisplay();
            console.log('Test items added:', cart);
        }
        
        // Add test buttons
        document.addEventListener('DOMContentLoaded', function() {
            const buttonContainer = document.createElement('div');
            buttonContainer.className = 'flex space-x-4 mb-4';
            
            const testButton = document.createElement('button');
            testButton.textContent = 'Thêm sản phẩm test';
            testButton.className = 'bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600';
            testButton.onclick = addTestItems;
            
            const debugButton = document.createElement('button');
            debugButton.textContent = 'Debug giỏ hàng';
            debugButton.className = 'bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600';
            debugButton.onclick = function() {
                debugCart();
                alert('Đã in thông tin debug ra console (F12 để xem)');
            };
            
            const clearButton = document.createElement('button');
            clearButton.textContent = 'Xóa tất cả';
            clearButton.className = 'bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600';
            clearButton.onclick = function() {
                clearCart();
                alert('Đã xóa tất cả sản phẩm trong giỏ hàng');
            };
            
            const testRemoveButton = document.createElement('button');
            testRemoveButton.textContent = 'Test xóa item đầu tiên';
            testRemoveButton.className = 'bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600';
            testRemoveButton.onclick = function() {
                if (cart.length > 0) {
                    const firstItem = cart[0];
                    testRemoveItem(firstItem.id, firstItem.size, firstItem.color);
                    alert('Đã test xóa item đầu tiên, xem console (F12)');
                } else {
                    alert('Giỏ hàng trống!');
                }
            };
            
            const forceRemoveButton = document.createElement('button');
            forceRemoveButton.textContent = 'Force xóa item đầu tiên';
            forceRemoveButton.className = 'bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600';
            forceRemoveButton.onclick = function() {
                forceRemoveFirst();
                alert('Đã force xóa item đầu tiên');
            };
            
            buttonContainer.appendChild(testButton);
            buttonContainer.appendChild(debugButton);
            buttonContainer.appendChild(clearButton);
            buttonContainer.appendChild(testRemoveButton);
            buttonContainer.appendChild(forceRemoveButton);
            
            document.querySelector('.max-w-4xl').insertBefore(buttonContainer, document.querySelector('.bg-white'));
        });
    </script>
</body>
</html>
